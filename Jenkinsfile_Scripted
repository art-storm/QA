node {

    def imagename = "igorunnamed/test-app-java"
    def dockerImage = ''

    stage('Clone sources') {
        git url: 'https://github.com/art-storm/QA.git'
    }

    stage('Build') {
        sh 'mvn -B -DskipTests clean package'
    }

    stage('Test') {
        sh 'mvn test'
    }

    stage('Building image') {
        dockerImage = docker.build imagename
    }

}